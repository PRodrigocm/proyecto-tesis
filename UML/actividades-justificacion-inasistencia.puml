@startuml
!theme plain
title Actividades: Justificación de Inasistencias

|Apoderado|
start
:Iniciar sesión en el sistema;
:Acceder a sección de justificaciones;
:Consultar inasistencias pendientes;

|Sistema|
:Buscar inasistencias sin justificar;
:Filtrar por estudiantes del apoderado;
:Mostrar lista de inasistencias;

|Apoderado|
if (¿Hay inasistencias pendientes?) then (No)
  :Mostrar mensaje "No hay inasistencias pendientes";
  stop
endif

:Seleccionar inasistencia a justificar;
:Acceder al formulario de justificación;

partition "Completar Justificación" {
  :Seleccionar tipo de justificación;
  note right: Tipos disponibles:\n- Médica\n- Familiar\n- Personal\n- Otra
  
  :Escribir motivo detallado;
  :Proporcionar descripción completa;
  
  if (¿Requiere documento de respaldo?) then (Sí)
    :Seleccionar archivo a subir;
    :Validar formato del archivo;
    note right: Formatos permitidos:\n- PDF\n- JPG/JPEG\n- PNG\nTamaño máximo: 10MB
    
    if (¿Archivo válido?) then (No)
      :Mostrar error de formato;
      :Solicitar archivo correcto;
    endif
  endif
  
  :Enviar justificación;
}

|Sistema|
:Validar datos del formulario;
:Crear registro de justificación;
:Cambiar estado a "PENDIENTE";

if (¿Hay documento adjunto?) then (Sí)
  :Guardar archivo en almacenamiento;
  :Asociar documento a justificación;
endif

:Notificar a docentes/auxiliares para revisión;

|Apoderado|
:Recibir confirmación de envío;
:Ver justificación en estado "Pendiente";

|Docente/Auxiliar|
:Recibir notificación de nueva justificación;
:Acceder al sistema;
:Consultar justificaciones pendientes;
:Seleccionar justificación para revisar;

partition "Proceso de Revisión" {
  :Leer motivo y descripción;
  :Revisar documentos adjuntos;
  :Verificar validez de la justificación;
  
  if (¿Documentos suficientes?) then (No)
    :Solicitar documentación adicional;
    :Agregar observaciones;
    |Sistema|
    :Cambiar estado a "REQUIERE_DOCUMENTOS";
    :Notificar al apoderado;
    |Apoderado|
    :Recibir notificación;
    :Completar documentación;
    |Docente/Auxiliar|
  endif
  
  if (¿Justificación válida?) then (Sí)
    :Aprobar justificación;
    :Agregar comentarios de aprobación;
    
    |Sistema|
    :Cambiar estado a "APROBADA";
    :Aplicar justificación a asistencias;
    :Cambiar estado de asistencias a "JUSTIFICADA";
    :Notificar aprobación al apoderado;
    
  else (No)
    :Rechazar justificación;
    :Especificar motivo de rechazo;
    
    |Sistema|
    :Cambiar estado a "RECHAZADA";
    :Registrar motivo de rechazo;
    :Notificar rechazo al apoderado;
  endif
}

|Apoderado|
:Recibir notificación del resultado;

if (¿Justificación aprobada?) then (Sí)
  :Ver asistencias actualizadas;
  :Justificación completada;
else (No)
  :Revisar motivo de rechazo;
  
  if (¿Desea apelar?) then (Sí)
    :Presentar nueva justificación;
    note right: Con documentación\nadicional o corregida
  endif
endif

|Sistema|
:Registrar en historial de justificaciones;
:Actualizar estadísticas de asistencia;
:Generar reportes actualizados;

stop

@enduml
